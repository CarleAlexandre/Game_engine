# HAVEN GAME ENGINE

___

this game engine is currently in very early stage.

it's a game engine written in c99 using opengl, raylib, FastNoiseLite, glad.

this engine is inteded to build voxel games with realistic terrain generation and procedural generation.

___

## World of Haven : Chaos dungeons

___

this will be the first game made with this engine.
___

## Design

prerequisite:

windows:

- need raylib, mingw with gcc and pthread, and gnumake.

```sh
	make

	make all
	
	make unit
	
	make lib
	
	make game
	
	make editor
	
	make server 
```

linux:

- need raylib
- not finished yet

mac os:

- not supported for now

___

## DESIGN

every function should be like this:

	[module]_[submodule]_[use]();

	ex:

	alloc_pool_init();
	thread_mgr_init();


```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆ       Hybrid Client-Server Flow       â–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            
           â”‚     Game Client   â”‚            
           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            
           â”‚ â”‚  Input        â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”
           â”‚ â”‚  Processing   â”œâ”€â”¼â”€â”€â–ºâ”‚ Local â”‚
           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ Serverâ”‚
           â”‚         â”‚         â”‚   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚    
           â”‚ â”‚  Prediction  â”‚ â”‚       â”‚    
           â”‚ â”‚  & Rendering â”‚ â”‚       â”‚    
           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚    
           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚    
                 â”‚   â”‚   â”‚           â”‚    
                 â–¼   â–¼   â–¼           â–¼    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Shared Simulation Core        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Command Queue   â”‚  â”‚ World State   â”‚ â”‚
â”‚ â”‚ - Input buffer   â”‚  â”‚ - Chunk data  â”‚ â”‚
â”‚ â”‚ - Priority sortedâ”‚  â”‚ - Entities    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                    â”‚         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚          Simulation Loop           â”‚ â”‚
â”‚ â”‚ 1. Process commands                â”‚ â”‚
â”‚ â”‚ 2. Update physics                  â”‚ â”‚
â”‚ â”‚ 3. Generate snapshots              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                    
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         
          â”‚  Snapshot Delivery â”‚         
          â”‚ - Local: Memcpy    â”‚         
          â”‚ - Remote: Network  â”‚         
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         
                    â”‚                    
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         
          â”‚   Client State     â”‚         
          â”‚ Reconciliation     â”‚         
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         
```

### Communication Flow

```	
 Client Side              Server Side               Shared
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[Input Polling]       [Command Queue]
      â”‚                     â”‚
      â”œâ”€â”€User Inputâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚                    â”‚
[Prediction]          [Simulation Tick]
      â”‚                    â”‚
      â”‚â—„â”€â”€â”€World Snapshotâ”€â”€â”¤
      â”‚                    â”‚
[Render Interp.]      [State Broadcast]
      â”‚                     â”‚
      â”œâ”€â”€Correction Req.â”€â”€â–ºâ”‚
      â”‚                    â”‚
[State Apply]         [Delta Update]
```

### Sequence Diagram

```
Local Mode                          Remote Mode
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚    â”‚ Server â”‚            â”‚ Client â”‚    â”‚ Server â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚ Input       â”‚                     â”‚ Input       â”‚     
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚â”€â”€â”€via Netâ”€â”€â–ºâ”‚     
    â”‚             â”‚ Simulate            â”‚             â”‚     
    â”‚ Prediction  â”‚â”€â”€â”€â”                 â”‚ Prediction  â”‚     
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”˜                 â”‚â—„â”€â”€â”€via Netâ”€â”€â”‚     
    â”‚ Render      â”‚                     â”‚ Render      â”‚     
    â”‚             â”‚                     â”‚             â”‚ 
```

### Data Model Relationships

```
WorldSnapshot â—„â”€â”€â”€â”         â”Œâ”€â”€â”€â–º InputCommand
       â–²          â”‚         â”‚          â–²
       â”‚          â”œâ”€has aâ”€â”€â”€â”¤          â”‚
       â”‚          â”‚         â”‚          â”‚
       â”‚     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”   â”‚     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”¤  World   â”‚   â””â”€â”€â”€â”€â”€â”¤  Player  â”‚
             â”‚  State   â”‚         â”‚  State   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Memory Layout Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client Memory             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Predicted   â”‚ Command     â”‚
â”‚ World State â”‚ Buffer      â”‚
â”‚ (Write)     â”‚ (Ring)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚
       â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shared Memory             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Server      â”‚ Snapshot    â”‚
â”‚ World State â”‚ Buffer      â”‚
â”‚ (Read-Only) â”‚ (Double)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Metrics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client               â”‚ Server               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FPS: 60              â”‚ TPS: 20              â”‚
â”‚ Pred. Error: 0.2m    â”‚ Cmd Lag: 12ms        â”‚
â”‚ Chunks Rendered: 142 â”‚ Chunks Loaded: 256   â”‚
â”‚ VRAM: 1.4GB          â”‚ RAM: 2.1GB           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Debug Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Debug Overlay (F1)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Local Server: ACTIVE              [âœ”]   â”‚
â”‚ Snapshot Delay: 42ms              [â—]   â”‚
â”‚ Unacknowledged Commands: 3        [âš ]   â”‚
â”‚ Predicted vs Actual: 0.4m         [ğŸ”´]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Testing Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Test Case         â”‚ Visual Indicator      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Normal Operation  â”‚ Green network icon    â”‚
â”‚ High Latency      â”‚ Yellow ping counter   â”‚
â”‚ Prediction Error  â”‚ Red position marker   â”‚
â”‚ Server Desync     â”‚ Purple warning flash  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


___

## CREDIT

	raylib
	raygui
	librg
	fastNoiseLight
	enet.h

___
